#include "picosystem.hpp"

using namespace picosystem;

struct Board {
  int width = 10;
  int height = 24;
  int cell_size = 8;
  int margin_left = 50;
  int margin_top = 14;
  int cells[24][10] = { 0 };
};

struct Piece {
  int x = 0;
  int y = 0;
  int type = 0;
  int rotation = 0;
  bool can_hold = true;
};

struct Types {
  int count = 7;

  color_t colours[7] = {
    rgb(0, 14, 14),
    rgb(0, 0, 14),
    rgb(14, 10, 0),
    rgb(14, 14, 0),
    rgb(0, 14, 0),
    rgb(10, 0, 14),
    rgb(14, 0, 0)
  };

  int shapes[7][4][4][4] = {
    {
      {
        { 0, 0, 0, 0 },
        { 1, 1, 1, 1 },
        { 0, 0, 0, 0 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 1, 0 },
        { 0, 0, 1, 0 },
        { 0, 0, 1, 0 },
        { 0, 0, 1, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 0 },
        { 1, 1, 1, 1 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 1, 0, 0 },
        { 0, 1, 0, 0 },
        { 0, 1, 0, 0 },
        { 0, 1, 0, 0 }
      }
    },
    {
      {
        { 0, 0, 0, 0 },
        { 0, 2, 0, 0 },
        { 0, 2, 2, 2 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 2, 2 },
        { 0, 0, 2, 0 },
        { 0, 0, 2, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 0 },
        { 0, 2, 2, 2 },
        { 0, 0, 0, 2 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 2, 0 },
        { 0, 0, 2, 0 },
        { 0, 2, 2, 0 }
      }
    },
    {
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 3 },
        { 0, 3, 3, 3 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 3, 0 },
        { 0, 0, 3, 0 },
        { 0, 0, 3, 3 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 0 },
        { 0, 3, 3, 3 },
        { 0, 3, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 3, 3, 0 },
        { 0, 0, 3, 0 },
        { 0, 0, 3, 0 }
      }
    },
    {
      {
        { 0, 0, 0, 0 },
        { 0, 4, 4, 0 },
        { 0, 4, 4, 0 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 4, 4, 0 },
        { 0, 4, 4, 0 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 4, 4, 0 },
        { 0, 4, 4, 0 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 4, 4, 0 },
        { 0, 4, 4, 0 },
        { 0, 0, 0, 0 }
      }
    },
    {
      {
        { 0, 0, 0, 0 },
        { 0, 0, 5, 5 },
        { 0, 5, 5, 0 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 5, 0 },
        { 0, 0, 5, 5 },
        { 0, 0, 0, 5 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 0 },
        { 0, 0, 5, 5 },
        { 0, 5, 5, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 5, 0, 0 },
        { 0, 5, 5, 0 },
        { 0, 0, 5, 0 }
      }
    },
    {
      {
        { 0, 0, 0, 0 },
        { 0, 0, 6, 0 },
        { 0, 6, 6, 6 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 6, 0 },
        { 0, 0, 6, 6 },
        { 0, 0, 6, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 0 },
        { 0, 6, 6, 6 },
        { 0, 0, 6, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 6, 0 },
        { 0, 6, 6, 0 },
        { 0, 0, 6, 0 }
      }
    },
    {
      {
        { 0, 0, 0, 0 },
        { 0, 7, 7, 0 },
        { 0, 0, 7, 7 },
        { 0, 0, 0, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 7 },
        { 0, 0, 7, 7 },
        { 0, 0, 7, 0 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 0, 0 },
        { 0, 7, 7, 0 },
        { 0, 0, 7, 7 }
      },
      {
        { 0, 0, 0, 0 },
        { 0, 0, 7, 0 },
        { 0, 7, 7, 0 },
        { 0, 7, 0, 0 }
      }
    }
  };
};

enum states {
  TITLE,
  PLAYING,
  PAUSED,
  GAME_OVER
};
